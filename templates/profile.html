{% extends 'base.html' %}
{% load static %}

{% block content %}
  <!-- ***** Preloader Start ***** -->
  <div id="js-preloader" class="js-preloader">
    <div class="preloader-inner">
      <span class="dot"></span>
      <div class="dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>
  <!-- ***** Preloader End ***** -->

  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="page-content">

          <!-- ***** Banner Start ***** -->
          <div class="row">
            <div class="col-lg-12">
              <div class="main-profile ">
                <div class="row">
                  <div class="col-lg-4">
                    <img src={% static "assets/images/profile.jpg" %} alt="" style="border-radius: 23px;">
                  </div>
                  <div class="col-lg-4 align-self-center">
                    <div class="main-info header-text">
                      <span>Offline</span>
                      <h4>Kim Smithee</h4>
                      <p>You Haven't Gone Live yet. Go Live By Touching The Button Below.</p>
                      <div class="main-border-button">
                        <a href="#">Start Live Stream</a>
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-4 align-self-center">
                    <ul>
                      <li>내가 보유하고 있는 게임 <span style="margin-left: 15%">| {{ num_games }}</span></li>
                      <li>Friends Online <span style="margin-left: 30%"> | 16</span></li>
                      <li>Live Streams <span style="margin-left: 35%"> | None</span></li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- ***** Banner End ***** -->

          <!-- ***** Gaming Library Start ***** -->
          <div class="wrap">
            <div class="tab_menu">
              <ul class="list">
                <li class="is_on ajax_li">
                  <a class = "btn is_on" id="steam">Steam</a>
                  <div class="gaming-library profile-library cont">
                    <div class="col-lg-12">
                      <div class="heading-section">
                        <h4 id="most-played">가장 많이 플레이 한 게임</h4>
                      </div>
                      {% for data in datas %}
                        <div class="item">
                          <ul>
                            <li><img src={{ data.image }} alt="" class="templatemo-item"></li>
                            <li><h4>Title</h4><span>{{ data.name }}</span></li>
                            <li><h4>Genres</h4><span>{{ data.genre }}</span></li>
                            <li><h4>Hours Played</h4><span>{{ data.played_time }}</span></li>
                            <li><h4>Last Played</h4><span>{{ data.last_played }}</span></li>
                            <li><div class="main-border-button border-no-active"><a href="#">상세 정보</a></div></li>
                          </ul>
                        </div>
                      {% endfor %}
                    </div>
                  </div>
                </li>
                <li class="ajax_li">
                  <a class = "btn" id="riot">Riot</a>
                  <div class="gaming-library profile-library cont">
                    <div class="heading-section">
                      <h4 id="most-played">준비 중 입니다.</h4>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </div>
          <!-- ***** Gaming Library End ***** -->
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
  <script src={% static "vendor/jquery/jquery.min.js" %}></script>
  <script src={% static "vendor/bootstrap/js/bootstrap.min.js" %}></script>

  <script src={% static "assets/js/isotope.min.js" %}></script>
  <script src={% static "assets/js/owl-carousel.js" %}></script>
  <script src={% static "assets/js/tabs.js" %}></script>
  <script src={% static "assets/js/popup.js" %}></script>
  <script src={% static "assets/js/custom.js" %}></script>

  <script type="text/javascript" src={% static "custom/js/custom.js" %}></script>
  <link href={% static "custom/css/custom.css" %} rel="stylesheet">
  

  <script>
    const tabList = document.querySelectorAll(".tab_menu .list li.ajax_li");
    const tabLink = document.querySelectorAll(".tab_menu .list li.ajax_li a.btn");
  
    console.log(tabLink, tabList)
    for(var tab of tabList){
      // .tab_menu .list li에 있는 녀석들 눌리면
      tab.querySelector(".btn").addEventListener("click", function(e){
        e.preventDefault();
          
        // .tab_menu .list에 있는 모든 a태그와 li태그의 클래스에서 is_on 삭제
        for(var j = 0; j < tabList.length; j++){

          tabList[j].classList.remove("is_on");
          tabLink[j].classList.remove("is_on");
        }
        
        // 눌린 녀석의 li와 a의 class에 is_on 붙여주기 
        this.parentNode.classList.add("is_on");
        this.classList.add("is_on");
  
        $.ajax({
          url     : "{% url 'profile:ajax_profile' %}",
          type    : "POST", dataType : "json",
          headers : {"X-CSRFToken" : "{{ csrf_token }}"},
          data    : JSON.stringify({"id" : this.id}),
          success : function(data){ 
                      console.log("Django 민수야 고맙다"); 
                      // document.all("most-played").innerHTML=data["most-played"];
                    },
          error   : function(request, error){ alert(request.status); }
        });
      });
    }
  </script>

  <style>
    ul.list{list-style:none;}
    a.btn{text-decoration:none; color:#333;}
    .wrap{padding:15px; letter-spacing:-0.5px;}
    .tab_menu{position:relative;}
    .tab_menu .list{overflow:hidden;}
    .tab_menu .list .btn{font-size:30px;}
    .tab_menu .list .cont{display:none;}
    .tab_menu .list .ajax_li {float : left}
    .tab_menu .list li.is_on .btn{font-weight:bold; 
                                  font-size:30px; 
                                  color:Yellow;}
    .tab_menu .list li.is_on .cont{display:block;}
  </style>

{% endblock %}